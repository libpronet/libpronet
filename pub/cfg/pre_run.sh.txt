#!/bin/sh

sysctl -w fs.file-max=4100000
cat /proc/sys/fs/file-max
cat /proc/sys/fs/file-nr

sysctl -w fs.nr_open=4100000
cat /proc/sys/fs/nr_open

echo "* soft nofile 4100000" >> /etc/security/limits.conf
echo "* hard nofile 4100000" >> /etc/security/limits.conf
ulimit -n 4100000
ulimit -n

sysctl -w net.ipv4.ip_local_port_range="1024 65535"
cat /proc/sys/net/ipv4/ip_local_port_range

THIS_DIR=`pwd`
LD_LIBRARY_PATH="${THIS_DIR}:${LD_LIBRARY_PATH}"
export LD_LIBRARY_PATH

#screen -S for_test_tcp_server
./test_tcp_server
#Ctrl-A, D
